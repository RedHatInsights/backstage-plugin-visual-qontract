{"version":3,"file":"static/1638.d05a145f.chunk.js","mappings":"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","sources":["webpack://internal.backstage-plugin-visual-app-interface/../../node_modules/@backstage/core-plugin-api/dist/index.esm.js"],"sourcesContent":["import { createVersionedContext, createVersionedValueMap, getOrCreateGlobalSingleton, useVersionedContext } from '@backstage/version-bridge';\nimport React, { useContext, useRef, useMemo, lazy, Suspense, useEffect, Children, isValidElement, Fragment } from 'react';\nimport { u as useApi, a as analyticsApiRef, f as featureFlagsApiRef } from './esm/StorageApi-c8a5e616.esm.js';\nexport { F as FeatureFlagState, S as SessionState, l as alertApiRef, a as analyticsApiRef, n as appThemeApiRef, k as atlassianAuthApiRef, i as bitbucketAuthApiRef, j as bitbucketServerAuthApiRef, p as configApiRef, c as createApiRef, q as discoveryApiRef, r as errorApiRef, f as featureFlagsApiRef, s as fetchApiRef, d as githubAuthApiRef, e as gitlabAuthApiRef, g as googleAuthApiRef, t as identityApiRef, m as microsoftAuthApiRef, x as oauthRequestApiRef, o as oktaAuthApiRef, h as oneloginAuthApiRef, y as storageApiRef, u as useApi, b as useApiHolder, v as vmwareCloudAuthApiRef, w as withApis } from './esm/StorageApi-c8a5e616.esm.js';\nimport { useLocation, useParams } from 'react-router-dom';\nimport '@backstage/errors';\n\nconst AnalyticsReactContext = createVersionedContext(\"analytics-context\");\nconst useAnalyticsContext = () => {\n  const theContext = useContext(AnalyticsReactContext);\n  if (theContext === void 0) {\n    return {\n      routeRef: \"unknown\",\n      pluginId: \"root\",\n      extension: \"App\"\n    };\n  }\n  const theValue = theContext.atVersion(1);\n  if (theValue === void 0) {\n    throw new Error(\"No context found for version 1.\");\n  }\n  return theValue;\n};\nconst AnalyticsContext = (options) => {\n  const { attributes, children } = options;\n  const parentValues = useAnalyticsContext();\n  const combinedValue = {\n    ...parentValues,\n    ...attributes\n  };\n  const versionedCombinedValue = createVersionedValueMap({ 1: combinedValue });\n  return /* @__PURE__ */ React.createElement(AnalyticsReactContext.Provider, { value: versionedCombinedValue }, children);\n};\n\nfunction createApiFactory(factory, instance) {\n  if (\"id\" in factory) {\n    return {\n      api: factory,\n      deps: {},\n      factory: () => instance\n    };\n  }\n  return factory;\n}\n\nconst globalEvents = getOrCreateGlobalSingleton(\n  \"core-plugin-api:analytics-tracker-events\",\n  () => ({\n    mostRecentGatheredNavigation: void 0,\n    mostRecentRoutableExtensionRender: void 0,\n    beforeUnloadRegistered: false\n  })\n);\nconst routableExtensionRenderedEvent = \"_ROUTABLE-EXTENSION-RENDERED\";\nclass Tracker {\n  constructor(analyticsApi, context = {\n    routeRef: \"unknown\",\n    pluginId: \"root\",\n    extension: \"App\"\n  }) {\n    this.analyticsApi = analyticsApi;\n    this.context = context;\n    if (!globalEvents.beforeUnloadRegistered) {\n      addEventListener(\n        \"beforeunload\",\n        () => {\n          if (globalEvents.mostRecentGatheredNavigation) {\n            this.analyticsApi.captureEvent({\n              ...globalEvents.mostRecentGatheredNavigation,\n              ...globalEvents.mostRecentRoutableExtensionRender\n            });\n            globalEvents.mostRecentGatheredNavigation = void 0;\n            globalEvents.mostRecentRoutableExtensionRender = void 0;\n          }\n        },\n        { once: true, passive: true }\n      );\n      globalEvents.beforeUnloadRegistered = true;\n    }\n  }\n  setContext(context) {\n    this.context = context;\n  }\n  captureEvent(action, subject, {\n    value,\n    attributes\n  } = {}) {\n    const { _routeNodeType, ...context } = this.context;\n    if (action === routableExtensionRenderedEvent) {\n      if (globalEvents.mostRecentGatheredNavigation) {\n        globalEvents.mostRecentRoutableExtensionRender = {\n          context: {\n            ...context,\n            extension: \"App\"\n          }\n        };\n      }\n      return;\n    }\n    if (globalEvents.mostRecentGatheredNavigation) {\n      try {\n        this.analyticsApi.captureEvent({\n          ...globalEvents.mostRecentGatheredNavigation,\n          ...globalEvents.mostRecentRoutableExtensionRender\n        });\n      } catch (e) {\n        console.warn(\"Error during analytics event capture. %o\", e);\n      }\n      globalEvents.mostRecentGatheredNavigation = void 0;\n      globalEvents.mostRecentRoutableExtensionRender = void 0;\n    }\n    if (action === \"navigate\" && _routeNodeType === \"gathered\" && context.pluginId === \"root\") {\n      globalEvents.mostRecentGatheredNavigation = {\n        action,\n        subject,\n        value,\n        attributes,\n        context\n      };\n      return;\n    }\n    try {\n      this.analyticsApi.captureEvent({\n        action,\n        subject,\n        value,\n        attributes,\n        context\n      });\n    } catch (e) {\n      console.warn(\"Error during analytics event capture. %o\", e);\n    }\n  }\n}\n\nfunction useAnalyticsApi() {\n  try {\n    return useApi(analyticsApiRef);\n  } catch {\n    return { captureEvent: () => {\n    } };\n  }\n}\nfunction useAnalytics() {\n  const trackerRef = useRef(null);\n  const context = useAnalyticsContext();\n  const analyticsApi = useAnalyticsApi();\n  function getTracker() {\n    if (trackerRef.current === null) {\n      trackerRef.current = new Tracker(analyticsApi);\n    }\n    return trackerRef.current;\n  }\n  const tracker = getTracker();\n  tracker.setContext(context);\n  return tracker;\n}\n\nconst useApp = () => {\n  const versionedContext = useVersionedContext(\n    \"app-context\"\n  );\n  if (!versionedContext) {\n    throw new Error(\"App context is not available\");\n  }\n  const appContext = versionedContext.atVersion(1);\n  if (!appContext) {\n    throw new Error(\"AppContext v1 not available\");\n  }\n  return appContext;\n};\n\nconst globalStore = getOrCreateGlobalSingleton(\n  \"component-data-store\",\n  () => /* @__PURE__ */ new WeakMap()\n);\nconst componentDataKey = \"__backstage_data\";\nfunction attachComponentData(component, type, data) {\n  var _a;\n  const dataComponent = component;\n  let container = (_a = dataComponent[componentDataKey]) != null ? _a : globalStore.get(component);\n  if (!container) {\n    container = { map: /* @__PURE__ */ new Map() };\n    Object.defineProperty(dataComponent, componentDataKey, {\n      enumerable: false,\n      configurable: true,\n      writable: false,\n      value: container\n    });\n    globalStore.set(component, container);\n  }\n  if (container.map.has(type)) {\n    const name = component.displayName || component.name;\n    throw new Error(\n      `Attempted to attach duplicate data \"${type}\" to component \"${name}\"`\n    );\n  }\n  container.map.set(type, data);\n}\nfunction getComponentData(node, type) {\n  var _a;\n  if (!node) {\n    return void 0;\n  }\n  const component = node.type;\n  if (!component) {\n    return void 0;\n  }\n  const container = (_a = component[componentDataKey]) != null ? _a : globalStore.get(component);\n  if (!container) {\n    return void 0;\n  }\n  return container.map.get(type);\n}\n\nconst routeRefType = getOrCreateGlobalSingleton(\n  \"route-ref-type\",\n  () => Symbol(\"route-ref-type\")\n);\n\nvar __defProp$3 = Object.defineProperty;\nvar __defNormalProp$3 = (obj, key, value) => key in obj ? __defProp$3(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __publicField$3 = (obj, key, value) => {\n  __defNormalProp$3(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n  return value;\n};\nvar _a$2;\nclass RouteRefImpl {\n  constructor(id, params) {\n    this.id = id;\n    this.params = params;\n    __publicField$3(this, _a$2, \"absolute\");\n  }\n  get title() {\n    return this.id;\n  }\n  toString() {\n    return `routeRef{type=absolute,id=${this.id}}`;\n  }\n}\n_a$2 = routeRefType;\nfunction createRouteRef(config) {\n  var _a2;\n  return new RouteRefImpl(\n    config.id,\n    (_a2 = config.params) != null ? _a2 : []\n  );\n}\n\nvar __defProp$2 = Object.defineProperty;\nvar __defNormalProp$2 = (obj, key, value) => key in obj ? __defProp$2(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __publicField$2 = (obj, key, value) => {\n  __defNormalProp$2(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n  return value;\n};\nvar _a$1;\nconst PARAM_PATTERN = /^\\w+$/;\nclass SubRouteRefImpl {\n  constructor(id, path, parent, params) {\n    this.id = id;\n    this.path = path;\n    this.parent = parent;\n    this.params = params;\n    __publicField$2(this, _a$1, \"sub\");\n  }\n  toString() {\n    return `routeRef{type=sub,id=${this.id}}`;\n  }\n}\n_a$1 = routeRefType;\nfunction createSubRouteRef(config) {\n  const { id, path, parent } = config;\n  const pathParams = path.split(\"/\").filter((p) => p.startsWith(\":\")).map((p) => p.substring(1));\n  const params = [...parent.params, ...pathParams];\n  if (parent.params.some((p) => pathParams.includes(p))) {\n    throw new Error(\n      \"SubRouteRef may not have params that overlap with its parent\"\n    );\n  }\n  if (!path.startsWith(\"/\")) {\n    throw new Error(`SubRouteRef path must start with '/', got '${path}'`);\n  }\n  if (path.endsWith(\"/\")) {\n    throw new Error(`SubRouteRef path must not end with '/', got '${path}'`);\n  }\n  for (const param of pathParams) {\n    if (!PARAM_PATTERN.test(param)) {\n      throw new Error(`SubRouteRef path has invalid param, got '${param}'`);\n    }\n  }\n  const subRouteRef = new SubRouteRefImpl(\n    id,\n    path,\n    parent,\n    params\n  );\n  return subRouteRef;\n}\n\nvar __defProp$1 = Object.defineProperty;\nvar __defNormalProp$1 = (obj, key, value) => key in obj ? __defProp$1(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __publicField$1 = (obj, key, value) => {\n  __defNormalProp$1(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n  return value;\n};\nvar _a;\nclass ExternalRouteRefImpl {\n  constructor(id, params, optional) {\n    this.id = id;\n    this.params = params;\n    this.optional = optional;\n    __publicField$1(this, _a, \"external\");\n  }\n  toString() {\n    return `routeRef{type=external,id=${this.id}}`;\n  }\n}\n_a = routeRefType;\nfunction createExternalRouteRef(options) {\n  var _a2;\n  return new ExternalRouteRefImpl(\n    options.id,\n    (_a2 = options.params) != null ? _a2 : [],\n    Boolean(options.optional)\n  );\n}\n\nfunction useRouteRef(routeRef) {\n  const { pathname } = useLocation();\n  const versionedContext = useVersionedContext(\n    \"routing-context\"\n  );\n  if (!versionedContext) {\n    throw new Error(\"Routing context is not available\");\n  }\n  const resolver = versionedContext.atVersion(1);\n  const routeFunc = useMemo(\n    () => resolver && resolver.resolve(routeRef, { pathname }),\n    [resolver, routeRef, pathname]\n  );\n  if (!versionedContext) {\n    throw new Error(\"useRouteRef used outside of routing context\");\n  }\n  if (!resolver) {\n    throw new Error(\"RoutingContext v1 not available\");\n  }\n  const isOptional = \"optional\" in routeRef && routeRef.optional;\n  if (!routeFunc && !isOptional) {\n    throw new Error(`No path for ${routeRef}`);\n  }\n  return routeFunc;\n}\n\nfunction useRouteRefParams(_routeRef) {\n  return useParams();\n}\n\nvar __defProp = Object.defineProperty;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __publicField = (obj, key, value) => {\n  __defNormalProp(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n  return value;\n};\nclass PluginErrorBoundary extends React.Component {\n  constructor() {\n    super(...arguments);\n    __publicField(this, \"state\", { error: void 0 });\n    __publicField(this, \"handleErrorReset\", () => {\n      this.setState({ error: void 0 });\n    });\n  }\n  static getDerivedStateFromError(error) {\n    return { error };\n  }\n  render() {\n    const { error } = this.state;\n    const { app, plugin } = this.props;\n    const { ErrorBoundaryFallback } = app.getComponents();\n    if (error) {\n      return /* @__PURE__ */ React.createElement(\n        ErrorBoundaryFallback,\n        {\n          error,\n          resetError: this.handleErrorReset,\n          plugin\n        }\n      );\n    }\n    return this.props.children;\n  }\n}\n\nfunction createRoutableExtension(options) {\n  const { component, mountPoint, name } = options;\n  return createReactExtension({\n    component: {\n      lazy: () => component().then(\n        (InnerComponent) => {\n          const RoutableExtensionWrapper = (props) => {\n            const analytics = useAnalytics();\n            try {\n              useRouteRef(mountPoint);\n            } catch (error) {\n              if (typeof error === \"object\" && error !== null) {\n                const { message } = error;\n                if (typeof message === \"string\" && message.startsWith(\"No path for \")) {\n                  throw new Error(\n                    `Routable extension component with mount point ${mountPoint} was not discovered in the app element tree. Routable extension components may not be rendered by other components and must be directly available as an element within the App provider component.`\n                  );\n                }\n              }\n              throw error;\n            }\n            useEffect(() => {\n              analytics.captureEvent(routableExtensionRenderedEvent, \"\");\n            }, [analytics]);\n            return /* @__PURE__ */ React.createElement(InnerComponent, { ...props });\n          };\n          const componentName = name || InnerComponent.displayName || InnerComponent.name || \"LazyComponent\";\n          RoutableExtensionWrapper.displayName = `RoutableExtension(${componentName})`;\n          return RoutableExtensionWrapper;\n        },\n        (error) => {\n          const RoutableExtensionWrapper = (_) => {\n            const app = useApp();\n            const { BootErrorPage } = app.getComponents();\n            return /* @__PURE__ */ React.createElement(BootErrorPage, { step: \"load-chunk\", error });\n          };\n          return RoutableExtensionWrapper;\n        }\n      )\n    },\n    data: {\n      \"core.mountPoint\": mountPoint\n    },\n    name\n  });\n}\nfunction createComponentExtension(options) {\n  const { component, name } = options;\n  return createReactExtension({ component, name });\n}\nfunction createReactExtension(options) {\n  const { data = {}, name } = options;\n  if (!name) {\n    console.warn(\n      \"Declaring extensions without name is DEPRECATED. Make sure that all usages of createReactExtension, createComponentExtension and createRoutableExtension provide a name.\"\n    );\n  }\n  let Component;\n  if (\"lazy\" in options.component) {\n    const lazyLoader = options.component.lazy;\n    Component = lazy(\n      () => lazyLoader().then((component) => ({ default: component }))\n    );\n  } else {\n    Component = options.component.sync;\n  }\n  const componentName = name || Component.displayName || Component.name || \"Component\";\n  return {\n    expose(plugin) {\n      const Result = (props) => {\n        const app = useApp();\n        const { Progress } = app.getComponents();\n        const mountPoint = data == null ? void 0 : data[\"core.mountPoint\"];\n        return /* @__PURE__ */ React.createElement(Suspense, { fallback: /* @__PURE__ */ React.createElement(Progress, null) }, /* @__PURE__ */ React.createElement(PluginErrorBoundary, { app, plugin }, /* @__PURE__ */ React.createElement(\n          AnalyticsContext,\n          {\n            attributes: {\n              pluginId: plugin.getId(),\n              ...name && { extension: name },\n              ...mountPoint && { routeRef: mountPoint.id }\n            }\n          },\n          /* @__PURE__ */ React.createElement(Component, { ...props })\n        )));\n      };\n      attachComponentData(Result, \"core.plugin\", plugin);\n      attachComponentData(Result, \"core.extensionName\", name);\n      for (const [key, value] of Object.entries(data)) {\n        attachComponentData(Result, key, value);\n      }\n      Result.displayName = `Extension(${componentName})`;\n      return Result;\n    }\n  };\n}\n\nfunction selectChildren(rootNode, featureFlagsApi, selector, strictError) {\n  return Children.toArray(rootNode).flatMap((node) => {\n    if (!isValidElement(node)) {\n      return [];\n    }\n    if (node.type === Fragment) {\n      return selectChildren(\n        node.props.children,\n        featureFlagsApi,\n        selector,\n        strictError\n      );\n    }\n    if (getComponentData(node, \"core.featureFlagged\")) {\n      const props = node.props;\n      const isEnabled = \"with\" in props ? featureFlagsApi.isActive(props.with) : !featureFlagsApi.isActive(props.without);\n      if (isEnabled) {\n        return selectChildren(\n          node.props.children,\n          featureFlagsApi,\n          selector,\n          strictError\n        );\n      }\n      return [];\n    }\n    if (selector === void 0 || selector(node)) {\n      return [node];\n    }\n    if (strictError) {\n      throw new Error(strictError);\n    }\n    return selectChildren(\n      node.props.children,\n      featureFlagsApi,\n      selector,\n      strictError\n    );\n  });\n}\nclass Collection {\n  constructor(node, featureFlagsApi) {\n    this.node = node;\n    this.featureFlagsApi = featureFlagsApi;\n  }\n  selectByComponentData(query) {\n    const selection = selectChildren(\n      this.node,\n      this.featureFlagsApi,\n      (node) => getComponentData(node, query.key) !== void 0,\n      query.withStrictError\n    );\n    return new Collection(selection, this.featureFlagsApi);\n  }\n  findComponentData(query) {\n    const selection = selectChildren(\n      this.node,\n      this.featureFlagsApi,\n      (node) => getComponentData(node, query.key) !== void 0\n    );\n    return selection.map((node) => getComponentData(node, query.key)).filter((data) => data !== void 0);\n  }\n  getElements() {\n    return selectChildren(this.node, this.featureFlagsApi);\n  }\n}\nfunction useElementFilter(node, filterFn, dependencies = []) {\n  const featureFlagsApi = useApi(featureFlagsApiRef);\n  const elements = new Collection(node, featureFlagsApi);\n  return useMemo(() => filterFn(elements), [node, ...dependencies]);\n}\n\nclass PluginImpl {\n  constructor(config) {\n    this.config = config;\n  }\n  getId() {\n    return this.config.id;\n  }\n  getApis() {\n    var _a;\n    return (_a = this.config.apis) != null ? _a : [];\n  }\n  getFeatureFlags() {\n    var _a, _b;\n    return (_b = (_a = this.config.featureFlags) == null ? void 0 : _a.slice()) != null ? _b : [];\n  }\n  get routes() {\n    var _a;\n    return (_a = this.config.routes) != null ? _a : {};\n  }\n  get externalRoutes() {\n    var _a;\n    return (_a = this.config.externalRoutes) != null ? _a : {};\n  }\n  provide(extension) {\n    return extension.expose(this);\n  }\n  toString() {\n    return `plugin{${this.config.id}}`;\n  }\n}\nfunction createPlugin(config) {\n  return new PluginImpl(config);\n}\n\nexport { AnalyticsContext, attachComponentData, createApiFactory, createComponentExtension, createExternalRouteRef, createPlugin, createReactExtension, createRoutableExtension, createRouteRef, createSubRouteRef, getComponentData, useAnalytics, useApp, useElementFilter, useRouteRef, useRouteRefParams };\n//# sourceMappingURL=index.esm.js.map\n"],"names":["AnalyticsReactContext","createVersionedContext","useAnalyticsContext","theContext","useContext","routeRef","pluginId","extension","theValue","atVersion","Error","AnalyticsContext","options","attributes","children","combinedValue","versionedCombinedValue","createVersionedValueMap","Provider","value","createApiFactory","factory","instance","api","deps","globalEvents","getOrCreateGlobalSingleton","mostRecentGatheredNavigation","mostRecentRoutableExtensionRender","beforeUnloadRegistered","routableExtensionRenderedEvent","Tracker","constructor","analyticsApi","context","this","addEventListener","captureEvent","once","passive","setContext","action","subject","_routeNodeType","e","console","warn","useAnalytics","trackerRef","useRef","u","a","useAnalyticsApi","tracker","current","useApp","versionedContext","useVersionedContext","appContext","globalStore","WeakMap","componentDataKey","attachComponentData","component","type","data","_a","dataComponent","container","get","map","Map","Object","defineProperty","enumerable","configurable","writable","set","has","name","displayName","getComponentData","node","routeRefType","Symbol","_a$2","__defProp$3","RouteRefImpl","id","params","key","obj","__defNormalProp$3","title","toString","createRouteRef","config","_a2","_a$1","__defProp$2","PARAM_PATTERN","SubRouteRefImpl","path","parent","__defNormalProp$2","createSubRouteRef","pathParams","split","filter","p","startsWith","substring","some","includes","endsWith","param","test","__defProp$1","ExternalRouteRefImpl","optional","__defNormalProp$1","createExternalRouteRef","Boolean","useRouteRef","pathname","useLocation","resolver","routeFunc","useMemo","resolve","isOptional","useRouteRefParams","_routeRef","useParams","__defProp","__publicField","__defNormalProp","PluginErrorBoundary","super","arguments","error","setState","getDerivedStateFromError","render","state","app","plugin","props","ErrorBoundaryFallback","getComponents","resetError","handleErrorReset","createRoutableExtension","mountPoint","createReactExtension","lazy","then","InnerComponent","RoutableExtensionWrapper","analytics","message","useEffect","componentName","_","BootErrorPage","step","createComponentExtension","Component","lazyLoader","default","sync","expose","Result","Progress","Suspense","fallback","getId","entries","selectChildren","rootNode","featureFlagsApi","selector","strictError","Children","toArray","flatMap","isValidElement","Fragment","isActive","with","without","Collection","selectByComponentData","query","selection","withStrictError","findComponentData","getElements","useElementFilter","filterFn","dependencies","f","elements","PluginImpl","getApis","apis","getFeatureFlags","_b","featureFlags","slice","routes","externalRoutes","provide","createPlugin"],"sourceRoot":""}